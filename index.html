<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Photo Collage</title>
    <script src="frame.js"></script>
</head>
<style>
    @keyframes fade_in {
        from {opacity: 0;}
        to {opacity: 1;}
    }

    @keyframes fade_out {
        from {opacity: 1;}
        to {opacity: 0;}
    }

    html,body {
        height: 99%;
        width: 99%;
        background-color: black;
    }

    div img {
        max-height: 100%;
        max-width: 100%;
        transform: translate(-50%, -50%);
        position: relative;
        left: 50%;
        top: 50%;
    }
</style>
<script>
    let frame_update_callbacks = []

    function on_resize() {
        let old_callbacks = []
        frame_update_callbacks.forEach(update_frame => {
            try { update_frame() }
            catch (e) {old_callbacks.push(update_frame)}
        })
        frame_update_callbacks = frame_update_callbacks.filter( function(element) {
            return !old_callbacks.includes(element);
        })
    }

    function insert_image() {
        let frame = new Frame(new Vector(Math.random(), Math.random()), 0.35, 4/3)
        frame.add_to_body()
        frame_update_callbacks.push(function() {frame.update()})
        frame.fade_in(5)
        let fadeout_delay = 10 * 1000
        setTimeout(function() { frame.fade_out(5) }, fadeout_delay)
        setTimeout(function() { frame.remove_from_body() }, fadeout_delay + (5 * 1000))
    }

    setInterval(insert_image, 1500)
</script>
<body onresize="on_resize()"></body>
</html>
